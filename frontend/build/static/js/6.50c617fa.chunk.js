(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[6,8],{202:function(e,t,n){"use strict";var o=n(29),r=n(290),c=n(295),i=n(192),a=n(300),s=n(294),l=n(159),u=n(0),d=n(205),j=(n(16),n(10)),b=n(217),h=n.n(b),m=n(209),g=n.n(m),O=n(2),f=Object(l.a)((function(e){return{Card:{backgroundColor:e.palette.secondary.main,margin:e.spacing(.4),width:"80%",justifyContent:"space-between"},roomCardMainDiv:{height:"100%",width:"100%",display:"grid",alignItems:"center",justifyItems:"center"}}}));t.a=function(e){var t=Object(j.g)();console.log(e);var n=f(),l=Object(u.useState)(!1),b=Object(o.a)(l,2),m=b[0],p=b[1];return Object(O.jsxs)("div",{className:n.roomCardMainDiv,children:[Object(O.jsx)(r.a,{className:n.Card,clickable:!0,onClick:function(){return t.push("/room/".concat(e.room.id))},children:Object(O.jsxs)(c.a,{children:[Object(O.jsx)(i.a,{onClick:function(){return p(!0)},gutterBottom:!0,children:e.room&&e.room.room_name}),e.invite&&Object(O.jsx)(a.a,{label:"creater : ".concat(e.room.created_by.first_name)}),Object(O.jsxs)("div",{style:{marginInlineStart:"auto"},children:[!e.invite&&Object(O.jsx)(s.a,{children:Object(O.jsx)(g.a,{onClick:function(e){e.stopPropagation(),p(!0)}})}),Object(O.jsx)(s.a,{children:Object(O.jsx)(h.a,{onClick:function(n){n.stopPropagation(),t.push("/video/".concat(e.room.id,"/").concat(e.room.sharing_id))}})})]})]})}),m&&Object(O.jsx)(d.a,{room:e.room,onClick:function(e){return e.stopPropagation()},show:m,onClose:function(){return p(!1)}})]})}},203:function(e,t,n){"use strict";var o=n(0),r=n(16),c=n(10),i=n(290),a=n(291),s=n(192),l=n(56),u=n(202),d=n(159),j=n(2),b=Object(d.a)((function(e){return{roomsList:{width:"80%",display:"grid",justifyItems:"center",overflow:"hidden",paddingBottom:e.spacing(1),gridTemplateRows:"min-content",height:"80%"},list:{overflowY:"scroll",maxHeight:window.screen.availHeight/2,width:"100%",display:"grid",justifyItems:"center",position:"absolute"},listHeading:{top:0,backgroundColor:e.palette.primary.main,width:"100%",height:"50%",marginLeft:"10%"},listWrapper:{position:"relative",width:"100%",height:"90%",overflow:"hidden"},webkitScrollbar:{width:0,background:"transparent"},webkitScrollbarThumb:{background:"#FF0000"}}}));t.a=Object(c.h)(Object(r.b)((function(e){return{user:e.auth.user,roomsCreated:e.room.roomsCreated,roomsInvited:e.room.roomsInvited}}),(function(e){return{createChatRoom:function(t,n){return e(Object(l.b)(t,n))},getAllRooms:function(){return e(Object(l.d)())}}}))((function(e){Object(c.g)();Object(o.useEffect)((function(){e.getAllRooms()}),[]);var t=b();return Object(j.jsxs)(i.a,{className:t.roomsList,children:[Object(j.jsx)(a.a,{color:"secondary",className:t.listHeading,children:Object(j.jsx)(s.a,{variant:"h5",children:e.heading})}),Object(j.jsx)(a.a,{className:t.listWrapper,children:Object(j.jsx)("div",{className:t.list,children:e.rooms.map((function(t){return Object(j.jsx)(u.a,{room:t,invite:"Your Invites"==e.heading})}))})})]})})))},205:function(e,t,n){"use strict";var o=n(29),r=n(40),c=n(198),i=n(298),a=n(293),s=n(294),l=n(108),u=n(159),d=n(292),j=n(16),b=n(204),h=n.n(b),m=(n(207),n(0)),g=n(56),O=n(208),f=n(2),p=["show","room","onClose","label"],x=Object(u.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.secondary.main,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},textField:{}}}));t.a=Object(j.b)((function(e){return{currentRoom:e.room.currentRoom}}),(function(e){return{updateRoomUsers:function(t,n,o){return e(Object(g.g)(t,n,o))}}}))((function(e){var t=x(),n=e.show,u=(e.room,e.onClose),j=(e.label,Object(r.a)(e,p),Object(m.useState)("")),b=Object(o.a)(j,2),g=b[0],v=b[1];function y(){O.b.success("Added user"),v("")}return Object(f.jsx)(c.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:t.modal,open:n,centered:!0,onClose:u,children:Object(f.jsx)(d.a,{in:n,children:Object(f.jsxs)("div",{className:t.paper,children:[Object(f.jsx)(O.a,{}),Object(f.jsx)("h2",{id:"transition-modal-title",children:e.room.room_name}),Object(f.jsx)("div",{id:"transition-modal-description",children:Object(f.jsx)(i.a,{color:"secondary",className:t.textfield,onChange:function(e){v(e.target.value)},value:g,name:"email",variant:"outlined",autoComplete:!1,label:"",placeholder:"Enter user email",InputProps:{endAdornment:Object(f.jsx)(a.a,{position:"end",children:Object(f.jsx)(s.a,{children:Object(f.jsx)(l.a,{onClick:function(){var t={email:g};e.updateRoomUsers(t,e.room.id,y)},children:Object(f.jsx)(h.a,{})})})})}})})]})})})}))},206:function(e,t,n){"use strict";var o=n(0),r=n(16),c=n(10),i=n(192),a=n(193),s=n(56),l=(n(202),n(159)),u=n(203),d=n(2),j=Object(l.a)((function(e){return{roomDetailsDiv:{width:"100%",display:"grid",justifyItems:"center",height:"90%",alignItems:"center"}}}));t.a=Object(c.h)(Object(r.b)((function(e){return{user:e.auth.user,roomsCreated:e.room.roomsCreated,roomsInvited:e.room.roomsInvited}}),(function(e){return{createChatRoom:function(t,n){return e(Object(s.b)(t,n))},getAllRooms:function(){return e(Object(s.d)())}}}))((function(e){var t=Object(c.g)();Object(o.useEffect)((function(){e.getAllRooms()}),[]);var n=j();return Object(d.jsxs)("div",{className:n.roomDetailsDiv,children:[Object(d.jsx)(u.a,{heading:"Your rooms",rooms:e.roomsCreated.slice(0,2)}),Object(d.jsx)(u.a,{heading:"Your Invites",rooms:e.roomsInvited.slice(0,2)}),Object(d.jsx)(i.a,{variant:"h6",className:n.title,children:Object(d.jsx)(a.a,{onClick:function(){return t.push("/rooms")},children:"View All"})})]})})))},207:function(e,t,n){"use strict";n.r(t);var o=n(76),r=n(196),c=n(159),i=n(0),a=n(16),s=(n(30),n(56)),l=(n(206),n(203)),u=n(2),d=Object(c.a)((function(e){return{Rooms:Object(o.a)({display:"grid",gridAutoFlow:"column",justifyItems:"center",padding:e.spacing(2),alignItems:"center",position:"relative",height:"100%"},e.breakpoints.down("xs"),{gridAutoFlow:"row"})}}));t.default=Object(a.b)((function(e){return{user:e.auth.user,roomsCreated:e.room.roomsCreated,roomsInvited:e.room.roomsInvited}}),(function(e){return{getAllRooms:function(){return e(Object(s.d)())}}}))((function(e){Object(i.useEffect)((function(){e.getAllRooms()}),[]);var t=d();return Object(u.jsxs)(r.a,{className:t.Rooms,children:[Object(u.jsx)(l.a,{rooms:e.roomsCreated,heading:"Your Rooms"}),Object(u.jsx)(l.a,{rooms:e.roomsInvited,heading:"Your Invites"})]})}))},218:function(e,t,n){"use strict";var o=n(76),r=n(0),c=n(16),i=n(10),a=n(196),s=n(194),l=n(158),u=n(239),d=n(56),j=(n(32),n(212)),b=n(159),h=n(2),m=Object(b.a)((function(e){return{roomChatDiv:{height:"100%"},textfield:{position:"absolute",bottom:"0px",width:"100%",backgroundColor:e.palette.primary.main},chatBoxMessages:{padding:"2px",position:"relative",overflow:"hidden",height:"85%",width:"100%"},messageList:Object(o.a)({maxHeight:"100%",top:0,left:0,right:-e.spacing(2),position:"absolute",overflowY:"scroll"},e.breakpoints.down("md"),{right:0})}}));t.a=Object(i.h)(Object(c.b)((function(e){return{user:e.auth.user,currentRoom:e.room.currentRoom,messages:e.room.messages}}),(function(e){return{createChatRoom:function(t,n){return e(Object(d.b)(t,n))},getAllMessages:function(t,n){return e(Object(d.c)(t,n))},addMessage:function(t){return e(Object(d.a)(t))}}}))((function(e){Object(i.g)();var t=Object(r.useRef)(),n=m();Object(r.useEffect)((function(){console.log("room chat"),console.log(e),e.getAllMessages(e.match.params.id)}),[]),Object(r.useEffect)((function(){t.current&&(console.log(t.current.scrollTop),t.current.scrollTop=t.current.scrollHeight,console.log(t.current.scrollTop))}),[t.current,e.messages.length]);e.currentRoom;return Object(h.jsx)(a.a,{className:n.chatBoxMessages,children:Object(h.jsx)(s.a,{ref:t,className:n.messageList,children:e.messages.map((function(t){return Object(h.jsx)(l.a,{children:Object(h.jsxs)(a.a,{container:!0,children:[Object(h.jsx)(a.a,{item:!0,xs:12,children:Object(h.jsx)(u.a,{align:t.user.pk==e.user.pk?"right":"left",disableTypography:!0,secondary:Object(h.jsxs)("div",{children:[Object(h.jsx)("span",{style:{fontWeight:"bolder"},children:t.user.first_name})," ",Object(h.jsx)("span",{style:{fontWeight:"lighter",fontSize:"small"},children:Object(h.jsx)(j.a,{date:t.created_on})})]})})}),Object(h.jsx)(a.a,{item:!0,xs:12,children:Object(h.jsx)(u.a,{align:t.user.pk==e.user.pk?"right":"left",primary:t.message})})]})},t.id)}))})})})))},219:function(e,t,n){"use strict";var o=n(29),r=n(0),c=n(16),i=n(10),a=n(290),s=n(240),l=n(291),u=n(192),d=n(300),j=n(295),b=n(193),h=n(205),m=n(56),g=n(159),O=n(160),f=n.n(O),p=n(209),x=n.n(p),v=n(58),y=n(2),w=Object(g.a)((function(e){return{roomDataDiv:{width:"100%",display:"grid",justifyItems:"center",alignItems:"center"}}}));t.a=Object(i.h)(Object(c.b)((function(e){return{user:e.auth.user,currentRoom:e.room.currentRoom}}),(function(e){return{createChatRoom:function(t,n){return e(Object(m.b)(t,n))},getRoomDetails:function(){return e(Object(m.e)())}}}))((function(e){var t=Object(i.g)();Object(r.useEffect)((function(){}),[]);var n=w(),m=Object(r.useState)(!1),g=Object(o.a)(m,2),O=g[0],p=g[1],k=Object(c.c)((function(e){return e.room.currentRoom}));return Object(y.jsx)("div",{className:n.roomDataDiv,children:Object(y.jsxs)(a.a,{style:{textAlign:"center"},children:[Object(y.jsx)(s.a,{title:k&&k.room_name,subheader:Object(v.c)(k.created_on)}),Object(y.jsxs)(l.a,{children:[Object(y.jsx)(u.a,{style:{textAlign:"center"},variant:"h5",children:"Admin"}),Object(y.jsx)(d.a,{size:"medium",color:"default",label:"".concat(k.id&&k.created_by.email)})]}),Object(y.jsxs)(l.a,{children:[Object(y.jsx)(u.a,{style:{textAlign:"center"},variant:"h5",children:"All Users"}),k.id&&k.all_users.map((function(e){return Object(y.jsx)(d.a,{size:"medium",color:"secondary",label:"".concat(e.email)})}))]}),Object(y.jsxs)(j.a,{style:{justifyContent:"center"},children:[k.id&&k.created_by.pk==e.user.pk&&Object(y.jsx)(b.a,{variant:"contained",color:"secondary",className:n.createRoomButton,startIcon:Object(y.jsx)(x.a,{}),onClick:function(){return p(!0)},children:"Add User"}),e.meeting&&Object(y.jsx)(b.a,{variant:"contained",color:"secondary",className:n.createRoomButton,startIcon:Object(y.jsx)(f.a,{}),onClick:function(){t.push("/video/".concat(k.id,"/").concat(k.sharing_id))},children:"Join Meeting"}),O&&Object(y.jsx)(h.a,{room:k,show:O,onClose:function(){return p(!1)}})]})]})})})))},220:function(e,t,n){"use strict";var o=n(29),r=n(0),c=n(16),i=n(10),a=n(290),s=n(291),l=n(192),u=n(298),d=n(293),j=n(294),b=n(108),h=n(56),m=n(32),g=(n(212),n(159)),O=n(204),f=n.n(O),p=n(218),x=n(2),v=Object(g.a)((function(e){return{roomChatDiv:{position:"relative",height:"90%",backgroundColor:e.palette.background.default},textfield:{position:"absolute",bottom:"0px",width:"100%",backgroundColor:e.palette.primary.main},chatHeading:{top:"0px",backgroundColor:e.palette.primary.main},chatBoxMessages:{padding:"2px",position:"relative",overflow:"hidden",height:"85%",width:"100%"},messageList:{maxHeight:"100%",top:0,left:0,right:-e.spacing(2),position:"absolute",overflowY:"scroll"}}}));t.a=Object(i.h)(Object(c.b)((function(e){return{user:e.auth.user,currentRoom:e.room.currentRoom,messages:e.room.messages}}),(function(e){return{createChatRoom:function(t,n){return e(Object(h.b)(t,n))},getAllMessages:function(t,n){return e(Object(h.c)(t,n))},addMessage:function(t){return e(Object(h.a)(t))}}}))((function(e){Object(i.g)();Object(r.useEffect)((function(){return console.log("room chat"),console.log(e),e.getAllMessages(e.match.params.id),function(){m.a.close()}}),[]);var t=e.currentRoom;Object(r.useEffect)((function(){Boolean(m.a)&&m.a.socketRef&&m.a.close(),m.a.connect("".concat("http:"==window.location.protocol?"ws":"wss","://").concat(window.location.host.includes("localhost:")?"localhost:8000":window.location.hostname,"/ws/chat/").concat(e.currentRoom.sharing_id)),m.a.sendSignal("join room",{video:!1,audio:!1,onlyChat:!0}),m.a.on("message received",(function(t){t.user=JSON.parse(t.user),e.addMessage(t)}))}),[t.id]);var n=v(),c=Object(r.useState)(""),h=Object(o.a)(c,2),g=h[0],O=h[1];return Object(x.jsxs)(a.a,{className:n.roomChatDiv,children:[Object(x.jsx)(s.a,{color:"secondary",className:n.chatHeading,children:Object(x.jsx)(l.a,{variant:"h5",children:"Chat"})}),Object(x.jsx)(p.a,{}),Object(x.jsx)(u.a,{color:"secondary",className:n.textfield,onChange:function(e){O(e.target.value)},value:g,name:"message",variant:"outlined",autoComplete:!1,label:"",placeholder:"Enter your msg",InputProps:{endAdornment:Object(x.jsx)(d.a,{position:"end",children:Object(x.jsx)(j.a,{children:Object(x.jsx)(b.a,{onClick:function(){m.a.sendSignal("send_message",g),O("")},children:Object(x.jsx)(f.a,{})})})})}})]})})))},265:function(e,t){},267:function(e,t){},299:function(e,t,n){"use strict";n.r(t);var o=n(33),r=n(34),c=n(44),i=n(43),a=n(0),s=n.n(a),l=n(16),u=n(30),d=n(50),j=n(29),b=n(76),h=n(189),m=n(193),g=n(196),O=n(294),f=n(298),p=n(293),x=n(108),v=n(194),y=n(158),w=n(296),k=n(200),C=n(239),R=n(297),I=n(10),D=n(241),S=n.n(D),N=n(56),A=n(208),_=(n(212),n(32)),M=n(275),T=n.n(M),B=n(276),E=n.n(B),H=n(222),F=n.n(H),z=n(223),L=n.n(z),V=n(279),W=n.n(V),Y=n(277),P=n.n(Y),U=n(204),q=n.n(U),J=n(281),G=n.n(J),K=n(280),Q=n.n(K),X=n(157),Z=n(192),$=n(159),ee=n(2),te=Object($.a)((function(e){return{videoOffDiv:{overflow:"hidden",objectFit:"fill",backgroundSize:"cover",backgroundColor:e.palette.secondary.main,display:"grid",alignItems:"center",justifyItems:"center"}}})),ne=function(e){var t=te();return Object(ee.jsx)(X.a,{className:t.videoOffDiv,style:{width:e.width,height:e.height,display:e.video?"none":""},children:Object(ee.jsxs)("div",{children:[Object(ee.jsx)(Z.a,{variant:"h5",children:e.name}),e.audio?Object(ee.jsx)(F.a,{}):Object(ee.jsx)(L.a,{})]})})},oe=(n(220),n(290)),re=Object($.a)((function(e){return{video:{backgroundSize:"cover",objectFit:"fill",overflow:"hidden"}}})),ce=function(e){console.log(e.peer);var t=Object(a.useRef)(),n=re();return Object(a.useEffect)((function(){console.log("video started"),e.peer&&e.peer.on("stream",(function(e){console.log(e),t.current.srcObject=e}))}),[]),Object(ee.jsx)("video",{playsInline:!0,width:e.width,height:e.height,autoPlay:!0,style:{display:e.video?"block":"none"},className:n.video,ref:t})},ie=Object($.a)((function(e){return{video:{backgroundSize:"cover",objectFit:"fill",overflow:"hidden"},userDetailDiv:{position:"absolute",top:"0.4rem",color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)",height:"1.8rem",borderRadius:"0.3rem",padding:"0.2rem 0.4rem"},userDiv:{textAlign:"center",position:"relative",padding:e.spacing(1),margin:e.spacing(1),display:"grid",justifyContent:"center"}}})),ae=function(e){var t=ie();return Object(ee.jsx)(g.a,{container:!0,item:!0,xs:12,className:t.userDiv,style:{display:e.show?"":"none"},children:Object(ee.jsxs)(oe.a,{children:[e.refer?Object(ee.jsx)("video",{width:e.width,height:e.height,playsInline:!0,muted:!0,style:{display:e.video?"block":"none"},autoPlay:!0,className:t.video,ref:e.refer}):Object(ee.jsx)(ce,{peer:e.peer.peer,video:e.video,dimension:e.dimensions,width:e.width,height:e.height,numpeers:e.numpeers}),Object(ee.jsx)(ne,{name:e.name,audio:e.audio,video:e.video,dimension:e.dimensions,width:e.width,height:e.height,numpeers:e.numpeers}),Object(ee.jsx)("div",{style:{display:e.video?"block":"none"},className:t.userDetailDiv,children:Object(ee.jsxs)(Z.a,{variant:"h5",gutterBottom:!0,children:[e.name," ",e.audio?Object(ee.jsx)(F.a,{}):Object(ee.jsx)(L.a,{})]})})]})})},se=n(218),le=n(282),ue=n.n(le),de=n(283),je=n.n(de),be=n(219),he=n(278),me=n.n(he),ge=Object(h.a)((function(e){var t;return{video:{backgroundSize:"cover",objectFit:"fill",overflow:"hidden"},gridContainer:Object(b.a)({justifyContent:"center"},e.breakpoints.down("md"),{flexDirection:"column"}),introLobby:{display:"grid",gridAutoFlow:"column",alignItems:"center",justifyContent:"center"},paper:{display:"grid",justifyContent:"space-around",alignItems:"center",overflow:"hidden",height:"100%",width:"100%",boxShadow:"none"},userDetailDiv:{position:"absolute"},userDiv:{textAlign:"center",position:"relative",padding:e.spacing(1),margin:e.spacing(1)},chatRoom:{height:"100%"},chatRoomMainDiv:{display:"grid",gridAutoFlow:"column",width:"100%",height:"100%",position:"relative"},chatBox:Object(b.a)({position:"relative",backgroundColor:e.palette.secondary.main,zIndex:5,minWidth:"30vh",maxHeight:"100%"},e.breakpoints.down("xs"),{position:"absolute",top:0,bottom:0,right:0,left:0,width:"100%",height:"100%"}),chatBoxIntro:{padding:"2px"},chatBoxMessages:{padding:"2px",position:"relative",overflow:"hidden",height:"85%",width:"100%"},messageList:{maxHeight:"100%",top:0,left:0,right:-e.spacing(2),position:"absolute",overflowY:"scroll"},actionButtons:(t={position:"absolute",bottom:"2rem",display:"grid",justifyContent:"center",boxShadow:"none",gridAutoFlow:"column",zIndex:3,marginLeft:"auto",marginRight:"auto"},Object(b.a)(t,e.breakpoints.up("md"),{right:0,left:0}),Object(b.a)(t,e.breakpoints.down("xs"),{gridAutoFlow:"row"}),t),textfield:{position:"absolute",bottom:"0px",width:"100%",backgroundColor:e.palette.primary.main}}})),Oe={},fe=s.a.memo((function(e){var t=Object(I.g)(),n=Object(l.c)((function(e){return e.room.currentRoom})),o=Object(a.useState)(!0),r=Object(j.a)(o,2),c=r[0],i=r[1],s=Object(a.useState)(!1),u=Object(j.a)(s,2),b=u[0],h=u[1],D=Object(a.useState)(),N=Object(j.a)(D,2),M=N[0],B=N[1],H=(Object(l.c)((function(e){return e.auth.token})),Object(a.useState)([])),z=Object(j.a)(H,2),V=z[0],Y=z[1],U=Object(a.useState)([]),J=Object(j.a)(U,2),K=(J[0],J[1],Object(a.useState)([])),X=Object(j.a)(K,2),Z=X[0],$=(X[1],Object(a.useState)([])),te=Object(j.a)($,2),ne=(te[0],te[1]),oe=(Object(a.useRef)(),Object(a.useState)(100)),re=Object(j.a)(oe,2),ce=re[0],ie=(re[1],Object(a.useState)(window.screen.availHeight/2)),le=Object(j.a)(ie,2),de=le[0],he=le[1],fe=Object(a.useState)(window.screen.availWidth/2),pe=Object(j.a)(fe,2),xe=pe[0],ve=pe[1],ye=Object(a.useRef)(),we=Object(a.useRef)(),ke=Object(a.useRef)(),Ce=Object(a.useRef)(),Re=Object(a.useState)(),Ie=Object(j.a)(Re,2),De=Ie[0],Se=Ie[1],Ne=Object(a.useState)(!0),Ae=Object(j.a)(Ne,2),_e=Ae[0],Me=Ae[1],Te=Object(a.useState)(0),Be=Object(j.a)(Te,2),Ee=Be[0],He=Be[1],Fe=Object(a.useState)(!0),ze=Object(j.a)(Fe,2),Le=ze[0],Ve=ze[1],We=Object(a.useState)(!0),Ye=Object(j.a)(We,2),Pe=Ye[0],Ue=Ye[1],qe=Object(a.useState)(!1),Je=Object(j.a)(qe,2),Ge=Je[0],Ke=Je[1],Qe=Object(a.useState)(!1),Xe=Object(j.a)(Qe,2),Ze=Xe[0],$e=Xe[1],et=Object(a.useState)(!0),tt=Object(j.a)(et,2),nt=tt[0],ot=tt[1],rt=Object(a.useState)(!1),ct=Object(j.a)(rt,2),it=ct[0],at=ct[1],st=Object(a.useRef)([]),lt=ge();function ut(){$e(!1),Ke(!Ge)}function dt(){Ke(!1),$e(!Ze)}function jt(){Ce.current.getVideoTracks()[0].enabled=!Ce.current.getVideoTracks()[0].enabled,c?Me(!_e):_.a.sendSignal("toggle video")}function bt(){Ce.current.getAudioTracks()[0].enabled=!Ce.current.getAudioTracks()[0].enabled,c?ot(!nt):_.a.sendSignal("toggle audio")}return Object(a.useEffect)((function(){return console.log("initialize"),e.getAllMessages(e.match.params.id),function(){Ce.current.getTracks().map((function(e){e.stop()})),Ce.current.getTracks()[1].stop(),_.a.close()}}),[]),Object(a.useEffect)((function(){console.log("peers changed"),console.log(V)}),[V]),Object(a.useEffect)((function(){console.log(Z.length),we.current&&(console.log(we.current.scrollTop),we.current.scrollTop=we.current.scrollHeight,console.log(we.current.scrollTop))}),[we.current,e.messages.length]),Object(a.useEffect)((function(){if(ke.current){var e=0;Le&&e++,e+=st.current.filter((function(e){return!0===e.show})).length,Ue(0==e);var t=Math.sqrt(e);t=ke.current.offsetHeight<ke.current.offsetWidth?Math.ceil(t):Math.floor(t),He(t);var n=Math.ceil(e/t);he(ke.current.offsetHeight/(1.2*n)),ve(ke.current.offsetWidth/(1.2*t)),console.log("dimension changed"),console.log(Ee)}}),[ke.current,V,Le,Ge,Ze,st.current.length]),Object(a.useEffect)((function(){console.log("currentroom.id changes"),console.log(n),e.getRoomDetails(e.match.params.id,(function(){console.log(n&&n.created_by.pk==e.myuser.pk),n&&n.created_by.pk==e.myuser.pk&&(navigator.mediaDevices.getUserMedia({video:{videoConstraints:Oe},audio:!0}).then((function(e){console.log(e),ye.current.srcObject=e,Ce.current=e,Se(e)})).catch((function(e){console.log(e),A.b.error("Cannot get access to your camera and video !")})),console.log("admin hai ye"),i(!1)),at(!0)}))}),[n.id]),Object(a.useEffect)((function(){it&&(c?navigator.mediaDevices.getUserMedia({video:{videoConstraints:Oe},audio:!0}).then((function(e){console.log(e),ye.current.srcObject=e,Ce.current=e,Se(e)})).catch((function(e){console.log(e),A.b.error("Cannot get access to your camera and video !")})):(Boolean(_.a)&&_.a.socketRef&&_.a.close(),_.a.connect("".concat("http:"==window.location.protocol?"ws":"wss","://").concat(window.location.host.includes("localhost:")?"localhost:8000":window.location.hostname,"/ws/chat/").concat(e.currentRoom.sharing_id)),ne(_.a),_.a.sendSignal("join room",{video:_e,audio:nt,onlyChat:!1}),_.a.on("request invite",(function(t){var o=-1!=e.currentRoom.all_users.indexOf(t.id);console.log(e.currentRoom.all_users),console.log(t.id==e.currentRoom.created_by.pk),console.log(t.id==e.currentRoom.created_by.pk||o),t.id==e.currentRoom.created_by.pk||o?_.a.sendSignal("accept invite",t.id):e.currentRoom.created_by.pk==e.myuser.pk&&n.created_by.pk!=t.id&&Object(A.b)((function(e){return Object(ee.jsxs)("div",{children:[t.email," wants to join"," ",Object(ee.jsx)(m.a,{color:"inherit",onClick:function(){return n=e.id,o=t.id,_.a.sendSignal("accept invite",o),void A.b.dismiss(n);var n,o},children:"accept"}),Object(ee.jsx)(m.a,{color:"inherit",onClick:function(){return n=e.id,o=t.id,_.a.sendSignal("reject invite",o),void A.b.dismiss(n);var n,o},children:"Decline"})]})}),{icon:"\ud83d\udc64",duration:1e5})})),_.a.on("invite was rejected",(function(n){console.log(e.myuser.pk==n.id),e.myuser.pk==n.id&&(alert("Admin rejected your request"),t.push("/"))})),_.a.on("all users",(function(t){if(1==b&&(console.log("pending req was true"),h(!1),ye.current.srcObject=Ce.current),t.id==e.myuser.pk){console.log("all users received"),console.log(t.users);var n=[];t.users.forEach((function(t){if(t[0]!==e.myuser.pk&&!Boolean(st.current.some((function(e){return e.peerID==t[0]})))){console.log(Ce.current);var o=function(e,t,n){var o=new S.a({initiator:!0,trickle:!1,stream:n});return o.on("signal",(function(n){_.a.sendSignal("sending signal",{userToSignal:e,callerID:t,signal:n})})),o}(t[0],e.myuser.pk,Ce.current);st.current.push({peerID:t[0],peerName:t[1],video:t[2],audio:t[3],show:!0,peer:o}),n.push({peerID:t[0],peerName:t[1],video:t[2],audio:t[3],show:!0,peer:o}),console.log("created peer "+t[1])}})),Y(n),console.log("peers after all users"),console.log(V)}})),_.a.on("user joined",(function(t){if(console.log(t.userID),t.userID===e.myuser.pk){if(!Boolean(st.current.some((function(e){return e.peerID==t.caller[0]})))){var n=function(e,t,n){var o=new S.a({initiator:!1,trickle:!1,stream:n}),r=t[0];return o.on("signal",(function(e){_.a.sendSignal("returning signal",{signal:e,callerID:r})})),o.signal(e),o}(t.signal,t.caller,Ce.current);Object(A.b)("".concat(t.caller[1]," joined the room."),{icon:"\ud83d\udc4f"}),console.log("".concat(t.caller[1]," joined the room.")),st.current.push({peerID:t.caller[0],peerName:t.caller[1],video:t.caller[2],audio:t.caller[3],show:!0,peer:n});var o={peerID:t.caller[0],peerName:t.caller[1],video:t.caller[2],audio:t.caller[3],show:!0,peer:n};Y([].concat(Object(d.a)(V),[o])),console.log("added peer")}console.log(V)}})),_.a.on("receiving returned signal",(function(t){(console.log("receiving returned signal"),t.userID===e.myuser.pk)&&st.current.find((function(e){return e.peerID===t.id})).peer.signal(t.signal);console.log(V)})),_.a.on("user left",(function(e){var t=st.current.find((function(t){return t.peerID===e}));t&&(Object(A.b)("".concat(t.peerName," left."),{icon:"\u2139\ufe0f"}),t.peer.destroy());var n=st.current.filter((function(t){return t.peerID!==e}));st.current=n,Y(n)})),_.a.on("message received",(function(t){t.user=JSON.parse(t.user),e.myuser.first_name==t.user.first_name||Ge||Object(A.b)("".concat(t.user.first_name," : ").concat(t.message),{icon:"\ud83d\udcac"}),e.addMessage(t)})),_.a.on("toggle video",(function(t){if(t.id==e.myuser.pk)Me(t.value);else{var n=st.current;for(var o in n)if(n[o].peerID==t.id){n[o].video=t.value;break}Y(Object(d.a)(n)),st.current=n}})),_.a.on("toggle audio",(function(t){if(t.id==e.myuser.pk)ot(t.value);else{var n=st.current;for(var o in n)if(n[o].peerID==t.id){n[o].audio=t.value;break}Y(Object(d.a)(n)),st.current=n}}))))}),[it,c]),console.log(b),console.log(c),console.log(V),it?c||b?Object(ee.jsxs)("div",{children:[Object(ee.jsxs)("div",{className:lt.introLobby,children:[Object(ee.jsx)(ae,{video:_e,audio:nt,dimensions:ce/Math.sqrt(1+st.current.length),width:xe,show:Le,height:de,refer:ye,name:e.myuser.first_name,numpeers:st.current.length},e.myuser.pk),Object(ee.jsxs)("div",{children:[Object(ee.jsx)(m.a,{onClick:jt,children:_e?Object(ee.jsx)(T.a,{}):Object(ee.jsx)(E.a,{})}),Object(ee.jsx)(m.a,{onClick:bt,children:nt?Object(ee.jsx)(F.a,{}):Object(ee.jsx)(L.a,{})}),Object(ee.jsx)(m.a,{onClick:function(){console.log("joining room"),h(!0),i(!1)},disabled:b,children:"Join room"})]})]}),Object(ee.jsx)(be.a,{meeting:!1})]}):Object(ee.jsxs)("div",{className:lt.chatRoom,children:[Object(ee.jsx)(A.a,{}),Object(ee.jsxs)("div",{className:lt.chatRoomMainDiv,children:[Object(ee.jsxs)(g.a,{container:!0,spacing:2,className:lt.paper,ref:ke,style:{gridTemplateColumns:"repeat(".concat(Ee,",1fr)"),position:Pe?"relative":""},children:[Object(ee.jsxs)(g.a,{className:lt.actionButtons,children:[Object(ee.jsx)(m.a,{onClick:jt,children:_e?Object(ee.jsx)(T.a,{}):Object(ee.jsx)(E.a,{})}),Object(ee.jsx)(m.a,{onClick:bt,children:nt?Object(ee.jsx)(F.a,{}):Object(ee.jsx)(L.a,{})}),Object(ee.jsx)(m.a,{onClick:ut,children:Object(ee.jsx)(P.a,{})}),Object(ee.jsx)(m.a,{onClick:dt,children:Object(ee.jsx)(me.a,{})}),Object(ee.jsx)(m.a,{onClick:function(){console.log(De),(De&&De.getTracks()).map((function(e){e.stop()})),t.push("/")},children:Object(ee.jsx)(W.a,{})}),Object(ee.jsx)(m.a,{onClick:function(){navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:"true"}).then((function(e){for(var t=0;t<st.current.length;t++)st.current[t].peer.replaceTrack(Ce.current.getVideoTracks()[0],e.getVideoTracks()[0],Ce.current);Y(Object(d.a)(st.current)),Ce.current.removeTrack(Ce.current.getVideoTracks()[0]),Ce.current.addTrack(e.getVideoTracks()[0])}))},children:Object(ee.jsx)(Q.a,{})})]}),Pe&&Object(ee.jsx)(be.a,{meeting:!1}),Object(ee.jsx)(ae,{video:_e,audio:nt,dimensions:ce/Math.sqrt(2+st.current.length),width:xe,height:de,show:Le,refer:ye,name:e.myuser.first_name,numpeers:st.current.length},e.myuser.pk-100),st.current.map((function(e){return console.log(e),Object(ee.jsx)(ae,{video:e.video,audio:e.audio,dimensions:ce/Math.sqrt(2+st.current.length),width:xe,height:de,refer:null,show:e.show,peer:e,name:e.peerName,numpeers:st.current.length},e.peerID)}))]}),Ge?Object(ee.jsxs)(g.a,{className:lt.chatBox,children:[Object(ee.jsx)(g.a,{className:lt.chatBoxIntro,children:Object(ee.jsx)(O.a,{children:Object(ee.jsx)(G.a,{onClick:ut})})}),Object(ee.jsx)(se.a,{}),Object(ee.jsx)(g.a,{className:lt.chatBoxInput,children:Object(ee.jsx)(f.a,{color:"secondary",className:lt.textfield,onChange:function(e){B(e.target.value)},value:M,name:"message",variant:"outlined",autoComplete:!1,label:"",placeholder:"Enter your msg",InputProps:{endAdornment:Object(ee.jsx)(p.a,{position:"end",children:Object(ee.jsx)(O.a,{children:Object(ee.jsx)(x.a,{onClick:function(){_.a.sendSignal("send_message",M),B("")},children:Object(ee.jsx)(q.a,{})})})})}})})]}):"",Ze?Object(ee.jsxs)(g.a,{className:lt.chatBox,children:[Object(ee.jsx)(g.a,{className:lt.chatBoxIntro,children:Object(ee.jsx)(O.a,{children:Object(ee.jsx)(G.a,{onClick:dt})})}),Object(ee.jsxs)(g.a,{children:[Object(ee.jsx)(v.a,{children:Object(ee.jsxs)(y.a,{children:[Object(ee.jsx)(w.a,{children:Object(ee.jsx)(k.a,{color:"inherit",children:e.myuser.first_name[0]})}),Object(ee.jsx)(C.a,{primary:e.myuser.first_name}),Object(ee.jsx)(O.a,{onClick:jt,children:_e?Object(ee.jsx)(T.a,{}):Object(ee.jsx)(E.a,{})}),Object(ee.jsx)(O.a,{onClick:bt,children:nt?Object(ee.jsx)(F.a,{}):Object(ee.jsx)(L.a,{})}),Object(ee.jsx)(O.a,{onClick:function(){Le?Ve(!1):(Ve(!0),ye.current&&(ye.current.srcObject=Ce.current))},children:Le?Object(ee.jsx)(ue.a,{}):Object(ee.jsx)(je.a,{})})]},"RemySharp")}),Object(ee.jsx)(R.a,{}),Object(ee.jsx)(g.a,{item:!0,xs:12,style:{padding:"10px"},children:Object(ee.jsx)(f.a,{id:"outlined-basic-email",label:"Search",variant:"outlined",fullWidth:!0})}),Object(ee.jsx)(R.a,{}),Object(ee.jsx)(v.a,{children:st.current.map((function(e){return console.log(e),Object(ee.jsxs)(y.a,{children:[Object(ee.jsx)(w.a,{children:Object(ee.jsx)(k.a,{color:"inherit",children:e.peerName[0]})}),Object(ee.jsx)(C.a,{primary:e.peerName,children:"Remy Sharp"}),Object(ee.jsx)(O.a,{disabled:!0,children:e.video?Object(ee.jsx)(T.a,{disabled:!0}):Object(ee.jsx)(E.a,{disabled:!0})}),Object(ee.jsx)(O.a,{disabled:!0,children:e.audio?Object(ee.jsx)(F.a,{disabled:!0}):Object(ee.jsx)(L.a,{disabled:!0})}),Object(ee.jsx)(O.a,{onClick:function(){return function(e){var t=st.current;for(var n in t)if(t[n].peerID==e.peerID){t[n].show=!t[n].show;break}Y(Object(d.a)(t)),st.current=t,console.log(st.current)}(e)},children:e.show?Object(ee.jsx)(ue.a,{}):Object(ee.jsx)(je.a,{})})]},"RemySharp")}))})]})]}):""]})]}):Object(ee.jsx)("div",{children:"Room doesnt exist"})})),pe=Object(I.h)(Object(l.b)((function(e){return{myuser:e.auth.user,currentRoom:e.room.currentRoom,token:e.auth.token,messages:e.room.messages,userDimension:e.room.userDimension}}),(function(e){return{getRoomDetails:function(t,n){return e(Object(N.e)(t,n))},getAllMessages:function(t,n){return e(Object(N.c)(t,n))},addMessage:function(t){return e(Object(N.a)(t))},setUserDimension:function(t){return e(Object(N.f)(t))}}}))(fe)),xe=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){return Object(ee.jsx)("div",{style:{height:"90vh"},className:"VideoView",children:Object(ee.jsx)(pe,{})})}}]),n}(a.Component);t.default=Object(l.b)((function(e){return{user:e.auth.user}}),(function(e){return{logoutUser:function(){return e(Object(u.c)())}}}))(xe)}}]);
//# sourceMappingURL=6.50c617fa.chunk.js.map