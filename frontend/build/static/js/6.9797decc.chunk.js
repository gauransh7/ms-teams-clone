(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[6,8],{198:function(e,t,n){"use strict";var r=n(36),o=n(0),c=n(13),a=n(12),i=n(292),s=n(294),l=n(188),u=n(75),d=n(48),j=n(293),b=n(301),h=n(291),m=n(156),O=n(199),f=n(212),g=n.n(f),p=n(203),x=n.n(p),v=n(2),k=Object(m.a)((function(e){return{Card:{backgroundColor:e.palette.secondary.main,color:e.palette.secondary.contrastText,margin:e.spacing(.4),width:"80%",cursor:"pointer",justifyContent:"space-between"},roomCardMainDiv:{height:"100%",width:"100%",display:"grid",alignItems:"center",justifyItems:"center"},icons:{color:e.palette.secondary.contrastText}}})),y=function(e){var t=Object(a.g)(),n=k(),r=Object(o.useState)(!1),c=Object(d.a)(r,2),s=c[0],u=c[1];return Object(v.jsxs)("div",{className:n.roomCardMainDiv,children:[Object(v.jsx)(i.a,{className:n.Card,onClick:function(){return t.push("/room/".concat(e.room.id))},children:Object(v.jsxs)(j.a,{children:[Object(v.jsx)(l.a,{onClick:function(){return u(!0)},gutterBottom:!0,children:e.room&&e.room.room_name}),e.invite&&Object(v.jsx)(b.a,{label:"creater : ".concat(e.room.created_by.first_name)}),Object(v.jsxs)("div",{style:{marginInlineStart:"auto"},children:[!e.invite&&Object(v.jsx)(h.a,{onClick:function(e){e.stopPropagation(),u(!0)},children:Object(v.jsx)(x.a,{className:n.icons})}),Object(v.jsx)(h.a,{onClick:function(n){n.stopPropagation(),t.push("/video/".concat(e.room.id,"/").concat(e.room.sharing_id))},children:Object(v.jsx)(g.a,{className:n.icons})})]})]})}),s&&Object(v.jsx)(O.a,{room:e.room,onClick:function(e){return e.stopPropagation()},show:s,onClose:function(){return u(!1)}})]})},w=Object(m.a)((function(e){return{roomsList:{width:"80%",display:"grid",justifyItems:"center",overflow:"hidden",paddingBottom:e.spacing(1),backgroundColor:e.palette.background,gridTemplateRows:"min-content",height:"80%"},list:Object(r.a)({overflowY:"scroll",maxHeight:window.screen.availHeight/1.3,width:"100%",display:"grid",justifyItems:"center",position:"absolute"},e.breakpoints.down("xs"),{maxHeight:window.screen.availHeight/2}),listHeading:{top:0,backgroundColor:e.palette.primary.main,width:"100%",height:"50%",marginLeft:"10%"},listWrapper:{position:"relative",width:"100%",height:"90%",overflow:"hidden",display:"grid"},webkitScrollbar:{width:0,background:"transparent"},webkitScrollbarThumb:{background:"#FF0000"}}}));t.a=Object(a.i)(Object(c.b)((function(e){return{user:e.auth.user,roomsCreated:e.room.roomsCreated,roomsInvited:e.room.roomsInvited}}),(function(e){return{createChatRoom:function(t,n){return e(Object(u.b)(t,n))},getAllRooms:function(){return e(Object(u.d)())}}}))((function(e){Object(a.g)();Object(o.useEffect)((function(){e.getAllRooms()}),[]);var t=w();return Object(v.jsxs)(i.a,{className:t.roomsList,children:[Object(v.jsx)(s.a,{color:"secondary",className:t.listHeading,children:Object(v.jsx)(l.a,{variant:"h5",children:e.heading})}),Object(v.jsx)(s.a,{className:t.listWrapper,children:Object(v.jsx)("div",{className:t.list,children:e.rooms.map((function(t){return Object(v.jsx)(y,{room:t,invite:"Your Invites"==e.heading},t.id)}))})})]})})))},199:function(e,t,n){"use strict";var r=n(48),o=n(37),c=n(194),a=n(298),i=n(290),s=n(291),l=n(106),u=n(156),d=n(289),j=n(13),b=n(202),h=n.n(b),m=(n(201),n(0)),O=n(75),f=n(27),g=n(2),p=["show","room","onClose","label"],x=Object(u.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.secondary.main,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},textField:{}}}));t.a=Object(j.b)((function(e){return{currentRoom:e.room.currentRoom}}),(function(e){return{updateRoomUsers:function(t,n,r){return e(Object(O.g)(t,n,r))}}}))((function(e){var t=x(),n=e.show,u=(e.room,e.onClose),j=(e.label,Object(o.a)(e,p),Object(m.useState)("")),b=Object(r.a)(j,2),O=b[0],v=b[1];function k(){f.b.success("Added user"),v("")}return Object(g.jsx)(c.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:t.modal,open:n,centered:!0,onClose:u,children:Object(g.jsx)(d.a,{in:n,children:Object(g.jsxs)("div",{className:t.paper,children:[Object(g.jsx)(f.a,{}),Object(g.jsx)("h2",{id:"transition-modal-title",children:e.room.room_name}),Object(g.jsx)("div",{id:"transition-modal-description",children:Object(g.jsx)(a.a,{color:"secondary",className:t.textfield,onChange:function(e){v(e.target.value)},value:O,name:"email",variant:"outlined",autoComplete:!1,label:"",placeholder:"Enter user email",InputProps:{endAdornment:Object(g.jsx)(i.a,{position:"end",children:Object(g.jsx)(s.a,{onClick:function(){var t={email:O};e.updateRoomUsers(t,e.room.id,k)},children:Object(g.jsx)(l.a,{children:Object(g.jsx)(h.a,{})})})})}})})]})})})}))},200:function(e,t,n){"use strict";var r=n(36),o=n(0),c=n(13),a=n(12),i=n(188),s=n(189),l=n(75),u=n(156),d=n(198),j=n(2),b=Object(u.a)((function(e){return{roomDetailsDiv:{width:"100%",height:"60%"},roomList:Object(r.a)({height:"100%",width:"100%",display:"grid",justifyItems:"center"},e.breakpoints.down("xs"),{display:"none"}),title:{textAlign:"center"}}}));t.a=Object(a.i)(Object(c.b)((function(e){return{user:e.auth.user,roomsCreated:e.room.roomsCreated,roomsInvited:e.room.roomsInvited}}),(function(e){return{createChatRoom:function(t,n){return e(Object(l.b)(t,n))},getAllRooms:function(){return e(Object(l.d)())}}}))((function(e){var t=Object(a.g)();Object(o.useEffect)((function(){e.getAllRooms()}),[]);var n=b();return Object(j.jsxs)("div",{className:n.roomDetailsDiv,children:[Object(j.jsxs)("div",{className:n.roomList,children:[Object(j.jsx)(d.a,{heading:"Your rooms",rooms:e.roomsCreated.slice(0,2)}),Object(j.jsx)(d.a,{heading:"Your Invites",rooms:e.roomsInvited.slice(0,2)})]}),Object(j.jsx)(i.a,{variant:"h6",className:n.title,children:Object(j.jsx)(s.a,{onClick:function(){return t.push("/rooms")},children:"View All Rooms"})})]})})))},201:function(e,t,n){"use strict";n.r(t);var r=n(36),o=n(192),c=n(156),a=n(0),i=n(13),s=(n(25),n(75)),l=(n(200),n(198)),u=n(2),d=Object(c.a)((function(e){return{Rooms:Object(r.a)({display:"grid",gridAutoFlow:"column",justifyItems:"center",padding:e.spacing(2),alignItems:"center",position:"relative",height:"100%"},e.breakpoints.down("xs"),{gridAutoFlow:"row"})}}));t.default=Object(i.b)((function(e){return{user:e.auth.user,roomsCreated:e.room.roomsCreated,roomsInvited:e.room.roomsInvited}}),(function(e){return{getAllRooms:function(){return e(Object(s.d)())}}}))((function(e){Object(a.useEffect)((function(){e.getAllRooms()}),[]);var t=d();return Object(u.jsxs)(o.a,{className:t.Rooms,children:[Object(u.jsx)(l.a,{rooms:e.roomsCreated,heading:"Your Rooms"}),Object(u.jsx)(l.a,{rooms:e.roomsInvited,heading:"Your Invites"})]})}))},208:function(e,t,n){"use strict";var r=n(48),o=n(0),c=n(13),a=n(12),i=n(292),s=n(237),l=n(294),u=n(188),d=n(301),j=n(293),b=n(189),h=n(199),m=n(75),O=n(156),f=n(207),g=n.n(f),p=n(203),x=n.n(p),v=n(56),k=n(2),y=Object(O.a)((function(e){return{roomDataDiv:{width:"100%",display:"grid",justifyItems:"center",alignItems:"center"}}}));t.a=Object(a.i)(Object(c.b)((function(e){return{user:e.auth.user,currentRoom:e.room.currentRoom}}),(function(e){return{createChatRoom:function(t,n){return e(Object(m.b)(t,n))},getRoomDetails:function(){return e(Object(m.e)())}}}))((function(e){var t=Object(a.g)();Object(o.useEffect)((function(){}),[]);var n=y(),m=Object(o.useState)(!1),O=Object(r.a)(m,2),f=O[0],p=O[1],w=Object(c.d)((function(e){return e.room.currentRoom}));return Object(k.jsx)("div",{className:n.roomDataDiv,children:Object(k.jsxs)(i.a,{style:{textAlign:"center",maxWidth:"60%"},children:[Object(k.jsx)(s.a,{title:w&&w.room_name,subheader:Object(v.c)(w.created_on)}),Object(k.jsxs)(l.a,{children:[Object(k.jsx)(u.a,{style:{textAlign:"center"},variant:"h5",children:"Admin"}),Object(k.jsx)(d.a,{size:"medium",color:"default",label:"".concat(w.id&&w.created_by.email)})]}),Object(k.jsxs)(l.a,{children:[Object(k.jsx)(u.a,{style:{textAlign:"center"},variant:"h5",children:"All Users"}),w.id&&w.all_users.map((function(e){return Object(k.jsx)(d.a,{style:{margin:"0.2rem"},size:"medium",color:"secondary",label:"".concat(e.email)})}))]}),Object(k.jsxs)(j.a,{style:{justifyContent:"center"},children:[w.id&&w.created_by.pk==e.user.pk&&Object(k.jsx)(b.a,{variant:"contained",color:"secondary",className:n.createRoomButton,startIcon:Object(k.jsx)(x.a,{}),onClick:function(){return p(!0)},children:"Add User"}),e.meeting&&Object(k.jsx)(b.a,{variant:"contained",color:"secondary",className:n.createRoomButton,startIcon:Object(k.jsx)(g.a,{}),onClick:function(){t.push("/video/".concat(w.id,"/").concat(w.sharing_id))},children:"Join Meeting"}),f&&Object(k.jsx)(h.a,{room:w,show:f,onClose:function(){return p(!1)}})]})]})})})))},213:function(e,t,n){"use strict";var r=n(4),o=n(38),c=n(39),a=n(82),i=function(){function e(){Object(o.a)(this,e),this.stream=null,this.token=null,this.config=null,this.callbacks={},this.socketRef=null}return Object(c.a)(e,[{key:"connect",value:function(e){var t=this;this.socketRef=new WebSocket(e),this.socketRef.onopen=function(){console.log("websocket open")},this.socketRef.onmessage=function(e){t.socketNewMessage(e.data)},this.socketRef.onerror=function(e){console.log(e)},this.socketRef.onclose=function(){console.log("websockets closed lets reopen")}}},{key:"close",value:function(){this.socketRef&&this.socketRef.close()}},{key:"on",value:function(e,t){this.callbacks[e]=t}},{key:"socketNewMessage",value:function(e){var t=JSON.parse(e),n=(t.peer,t.action),r=t.message;0!=Object.keys(this.callbacks).length&&this.callbacks[n](r)}},{key:"getSteam",value:function(){return this.stream}},{key:"sendMessage",value:function(e){try{this.socketRef.send(JSON.stringify(Object(r.a)({},e)))}catch(t){console.log(t.message)}}},{key:"sendSignal",value:function(e,t){try{this.waitForSocketConnection(function(){var n=JSON.stringify({peer:a.a.getState().auth.user,action:e,message:t});this.socketRef.send(n)}.bind(this),1e3)}catch(n){console.log(n.message)}}},{key:"state",value:function(){return this.socketRef.readyState}},{key:"waitForSocketConnection",value:function(e){var t=this;setTimeout((function(){1!==s.state()?t.waitForSocketConnection(e):e()}),100)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();i.instance=null;var s=i.getInstance();t.a=s},214:function(e,t,n){"use strict";var r=n(36),o=n(0),c=n.n(o),a=n(13),i=n(12),s=n(192),l=n(190),u=n(155),d=n(236),j=n(75),b=n(215),h=n(156),m=n(2),O=Object(h.a)((function(e){return{roomChatDiv:{height:"100%"},textfield:{position:"absolute",bottom:"0px",width:"100%",backgroundColor:e.palette.primary.main},chatBoxMessages:{padding:"2px",position:"relative",overflow:"hidden",height:"85%",width:"100%"},messageList:Object(r.a)({maxHeight:"100%",top:0,left:0,right:-e.spacing(2),position:"absolute",overflowY:"scroll"},e.breakpoints.down("md"),{right:0})}})),f=c.a.memo((function(){var e=Object(o.useRef)(),t=O(),n=Object(a.d)((function(e){return e.auth.user})),r=Object(a.d)((function(e){return e.room.messages})),c=Object(a.c)(),h=Object(i.h)().id;return Object(o.useEffect)((function(){c(Object(j.c)(h))}),[]),Object(o.useEffect)((function(){e.current&&(e.current.scrollTop=e.current.scrollHeight)}),[e.current,r.length]),Object(m.jsx)(s.a,{className:t.chatBoxMessages,children:Object(m.jsx)(l.a,{ref:e,className:t.messageList,children:r.map((function(e){return Object(m.jsx)(u.a,{children:Object(m.jsxs)(s.a,{container:!0,children:[Object(m.jsx)(s.a,{item:!0,xs:12,children:Object(m.jsx)(d.a,{align:e.user.pk==n.pk?"right":"left",disableTypography:!0,secondary:Object(m.jsxs)("div",{children:[Object(m.jsx)("span",{style:{fontWeight:"bolder"},children:e.user.first_name})," ",Object(m.jsx)("span",{style:{fontWeight:"lighter",fontSize:"small"},children:Object(m.jsx)(b.a,{date:e.created_on})})]})})}),Object(m.jsx)(s.a,{item:!0,xs:12,children:Object(m.jsx)(d.a,{align:e.user.pk==n.pk?"right":"left",primary:e.message})})]})},e.id)}))})})}));t.a=f},216:function(e,t,n){"use strict";var r=n(48),o=n(36),c=n(0),a=n(13),i=n(12),s=n(292),l=n(294),u=n(188),d=n(298),j=n(290),b=n(291),h=n(106),m=n(75),O=n(213),f=n(156),g=n(202),p=n.n(g),x=n(214),v=n(2),k=Object(f.a)((function(e){return{roomChatDiv:Object(o.a)({position:"relative",height:"90%",backgroundColor:e.palette.background.default},e.breakpoints.down("md"),{position:"absolute",width:"100%",bottom:0}),textfield:{position:"absolute",bottom:"0px",width:"100%",backgroundColor:e.palette.primary.main},chatHeading:{top:"0px",backgroundColor:e.palette.primary.main},chatBoxMessages:Object(o.a)({padding:"2px",position:"relative",overflow:"hidden",height:"82%",width:"100%"},e.breakpoints.down("xs"),{height:"75%"}),messageList:{maxHeight:"100%",top:0,left:0,right:-e.spacing(2),position:"absolute",overflowY:"scroll"}}}));t.a=Object(i.i)(Object(a.b)((function(e){return{user:e.auth.user,currentRoom:e.room.currentRoom,messages:e.room.messages}}),(function(e){return{createChatRoom:function(t,n){return e(Object(m.b)(t,n))},getAllMessages:function(t,n){return e(Object(m.c)(t,n))},addMessage:function(t){return e(Object(m.a)(t))}}}))((function(e){Object(c.useEffect)((function(){return e.getAllMessages(e.match.params.id),function(){O.a.close()}}),[]);var t=e.currentRoom;Object(c.useEffect)((function(){Boolean(O.a)&&O.a.socketRef&&O.a.close(),O.a.connect("".concat("http:"==window.location.protocol?"ws":"wss","://").concat(window.location.host.includes("localhost:")?"localhost:8000":window.location.hostname,"/ws/chat/").concat(e.currentRoom.sharing_id)),O.a.sendSignal("join room",{video:!1,audio:!1,onlyChat:!0}),O.a.on("message received",(function(t){t.user=JSON.parse(t.user),e.addMessage(t)}))}),[t.id]);var n=k(),o=Object(c.useState)(""),a=Object(r.a)(o,2),i=a[0],m=a[1];function f(){""!=i&&O.a.sendSignal("send_message",i),m("")}return Object(v.jsxs)(s.a,{className:n.roomChatDiv,children:[Object(v.jsx)(l.a,{color:"secondary",className:n.chatHeading,children:Object(v.jsx)(u.a,{variant:"h5",children:"Chat"})}),Object(v.jsx)(x.a,{}),Object(v.jsx)(d.a,{color:"secondary",className:n.textfield,onChange:function(e){m(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&f()},value:i,name:"message",variant:"outlined",autoComplete:!1,label:"",placeholder:"Enter your msg",InputProps:{endAdornment:Object(v.jsx)(j.a,{position:"end",children:Object(v.jsx)(b.a,{onClick:f,children:Object(v.jsx)(h.a,{children:Object(v.jsx)(p.a,{})})})})}})]})})))},217:function(e,t,n){"use strict";var r=n(37),o=n(194),c=n(156),a=n(289),i=n(13),s=n(75),l=n(208),u=n(2),d=["show","onClose","label"],j=Object(c.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.secondary.main,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},textField:{}}}));t.a=Object(i.b)((function(e){return{currentRoom:e.room.currentRoom}}),(function(e){return{updateRoomUsers:function(t,n,r){return e(Object(s.g)(t,n,r))}}}))((function(e){var t=j(),n=e.show,c=e.onClose;e.label,Object(r.a)(e,d);return Object(u.jsx)(o.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:t.modal,open:n,centered:!0,onClose:c,children:Object(u.jsx)(a.a,{in:n,children:Object(u.jsx)(l.a,{meeting:e.meeting})})})}))},262:function(e,t){},264:function(e,t){},299:function(e,t,n){"use strict";n.r(t);var r=n(38),o=n(39),c=n(43),a=n(42),i=n(0),s=n.n(i),l=n(13),u=n(25),d=n(50),j=n(48),b=n(36),h=n(185),m=n(189),O=n(192),f=n(157),g=n(191),p=n(291),x=n(298),v=n(290),k=n(106),y=n(190),w=n(155),C=n(296),R=n(196),S=n(236),N=n(297),I=n(12),D=n(238),T=n.n(D),A=n(75),M=n(27),B=(n(215),n(213)),_=n(217),E=n(272),H=n.n(E),F=n(273),V=n.n(F),L=n(219),W=n.n(L),P=n(220),U=n.n(P),z=n(276),J=n.n(z),Y=n(274),q=n.n(Y),K=n(202),G=n.n(K),Q=n(280),X=n.n(Q),Z=n(278),$=n.n(Z),ee=n(277),te=n.n(ee),ne=n(154),re=n(188),oe=n(156),ce=n(2),ae=Object(oe.a)((function(e){return{videoOffDiv:{overflow:"hidden",objectFit:"fill",backgroundSize:"cover",backgroundColor:e.palette.secondary.main,color:e.palette.secondary.contrastText,display:"grid",alignItems:"center",justifyItems:"center"}}})),ie=function(e){var t=ae();return Object(ce.jsx)(ne.a,{className:t.videoOffDiv,style:{width:e.width,height:e.height,display:e.video?"none":""},children:Object(ce.jsxs)("div",{children:[Object(ce.jsx)(re.a,{variant:"h5",children:e.name}),e.audio?Object(ce.jsx)(W.a,{}):Object(ce.jsx)(U.a,{})]})})},se=(n(216),n(292)),le=Object(oe.a)((function(e){return{video:{backgroundSize:"cover",objectFit:"fill",overflow:"hidden"}}})),ue=function(e){var t=Object(i.useRef)(),n=le();return Object(i.useEffect)((function(){e.peer&&e.peer.on("stream",(function(e){t.current.srcObject=e}))}),[]),Object(ce.jsx)("video",{playsInline:!0,width:e.width,height:e.height,controls:!0,autoPlay:!0,style:{display:e.video?"block":"none"},className:n.video,ref:t})},de=Object(oe.a)((function(e){return{video:{backgroundSize:"cover",objectFit:"fill",overflow:"hidden"},userDetailDiv:{position:"absolute",top:"0.4rem",color:"white",backgroundColor:"rgba(0, 0, 0, 0.5)",height:"1.8rem",borderRadius:"0.3rem",padding:"0.2rem 0.4rem"},userDiv:{textAlign:"center",position:"relative",padding:e.spacing(1),margin:e.spacing(1),display:"grid",justifyContent:"center"}}})),je=function(e){var t=de();return Object(ce.jsx)(O.a,{container:!0,item:!0,xs:12,className:t.userDiv,style:{display:e.show?"":"none"},children:Object(ce.jsxs)(se.a,{children:[e.refer?Object(ce.jsx)("video",{width:e.width,height:e.height,playsInline:!0,muted:!0,controls:!0,style:{display:e.video?"block":"none"},autoPlay:!0,className:t.video,ref:e.refer}):Object(ce.jsx)(ue,{peer:e.peer.peer,video:e.video,dimension:e.dimensions,width:e.width,height:e.height,numpeers:e.numpeers}),Object(ce.jsx)(ie,{name:e.name,audio:e.audio,video:e.video,dimension:e.dimensions,width:e.width,height:e.height,numpeers:e.numpeers}),Object(ce.jsx)("div",{style:{display:e.video?"block":"none"},className:t.userDetailDiv,children:Object(ce.jsxs)(re.a,{variant:"h5",gutterBottom:!0,children:[e.name," ",e.audio?Object(ce.jsx)(W.a,{}):Object(ce.jsx)(U.a,{})]})})]})})},be=n(214),he=n(281),me=n.n(he),Oe=n(282),fe=n.n(Oe),ge=n(279),pe=n.n(ge),xe=n(208),ve=n(275),ke=n.n(ve),ye=Object(h.a)((function(e){return{video:{backgroundSize:"cover",objectFit:"fill",overflow:"hidden"},gridContainer:Object(b.a)({justifyContent:"center"},e.breakpoints.down("md"),{flexDirection:"column"}),introLobby:{display:"grid",gridAutoFlow:"column",alignItems:"center",justifyContent:"center"},paper:{display:"grid",justifyContent:"space-around",alignItems:"center",overflow:"hidden",height:"100%",width:"100%",boxShadow:"none"},userDetailDiv:{position:"absolute"},userDiv:{textAlign:"center",position:"relative",padding:e.spacing(1),margin:e.spacing(1)},chatRoom:{height:"100%"},chatRoomMainDiv:{display:"grid",gridAutoFlow:"column",width:"100%",height:"100%",position:"relative"},chatBox:Object(b.a)({position:"relative",backgroundColor:e.palette.secondary.main,zIndex:5,minWidth:"30vh",maxHeight:"100%"},e.breakpoints.down("xs"),{position:"absolute",top:0,bottom:0,right:0,left:0,width:"100%",height:"100%"}),chatBoxIntro:{padding:"2px"},chatBoxMessages:{padding:"2px",position:"relative",overflow:"hidden",height:"85%",width:"100%"},messageList:{maxHeight:"100%",top:0,left:0,right:-e.spacing(2),position:"absolute",overflowY:"scroll"},actionButtons:{position:"absolute",bottom:0,display:"grid",justifyContent:"center",boxShadow:"none",gridAutoFlow:"column",zIndex:3,right:0,left:0},desktopButton:Object(b.a)({},e.breakpoints.down("xs"),{display:"none"}),mobileButton:Object(b.a)({display:"none"},e.breakpoints.down("xs"),{display:"block"}),textfield:{position:"absolute",bottom:"0px",width:"100%",backgroundColor:e.palette.primary.main}}})),we={},Ce=s.a.memo((function(e){var t=Object(I.g)(),n=Object(l.d)((function(e){return e.room.currentRoom})),r=Object(i.useState)(!0),o=Object(j.a)(r,2),c=o[0],a=o[1],s=Object(i.useState)(!1),u=Object(j.a)(s,2),b=u[0],h=u[1],D=Object(i.useState)(),A=Object(j.a)(D,2),E=A[0],F=A[1],L=(Object(l.d)((function(e){return e.auth.token})),Object(i.useState)([])),P=Object(j.a)(L,2),z=P[0],Y=P[1],K=Object(i.useState)([]),Q=Object(j.a)(K,2),Z=(Q[0],Q[1],Object(i.useState)([])),ee=Object(j.a)(Z,2),ne=(ee[0],ee[1],Object(i.useState)([])),re=Object(j.a)(ne,2),oe=(re[0],re[1]),ae=(Object(i.useRef)(),Object(i.useState)(100)),ie=Object(j.a)(ae,2),se=ie[0],le=(ie[1],Object(i.useState)(window.screen.availHeight/2.2)),ue=Object(j.a)(le,2),de=ue[0],he=ue[1],Oe=Object(i.useState)(window.screen.availWidth/2.2),ge=Object(j.a)(Oe,2),ve=ge[0],Ce=ge[1],Re=Object(i.useRef)(),Se=Object(i.useRef)(),Ne=Object(i.useRef)(),Ie=Object(i.useRef)(),De=Object(i.useState)(),Te=Object(j.a)(De,2),Ae=Te[0],Me=Te[1],Be=Object(i.useState)(null),_e=Object(j.a)(Be,2),Ee=_e[0],He=_e[1],Fe=Object(i.useState)(!0),Ve=Object(j.a)(Fe,2),Le=Ve[0],We=Ve[1],Pe=Object(i.useState)(0),Ue=Object(j.a)(Pe,2),ze=Ue[0],Je=Ue[1],Ye=Object(i.useState)(!1),qe=Object(j.a)(Ye,2),Ke=qe[0],Ge=qe[1],Qe=Object(i.useState)(!0),Xe=Object(j.a)(Qe,2),Ze=Xe[0],$e=Xe[1],et=Object(i.useState)(!0),tt=Object(j.a)(et,2),nt=tt[0],rt=tt[1],ot=Object(i.useState)(!1),ct=Object(j.a)(ot,2),at=ct[0],it=ct[1],st=Object(i.useState)(!1),lt=Object(j.a)(st,2),ut=lt[0],dt=lt[1],jt=Object(i.useState)(!0),bt=Object(j.a)(jt,2),ht=bt[0],mt=bt[1],Ot=Object(i.useState)(!1),ft=Object(j.a)(Ot,2),gt=ft[0],pt=ft[1],xt=Object(i.useRef)([]),vt=ye(),kt=Object(i.useState)(null),yt=Object(j.a)(kt,2),wt=yt[0],Ct=yt[1],Rt=Object(i.useState)(""),St=Object(j.a)(Rt,2),Nt=St[0],It=St[1];Object(i.useEffect)((function(){return e.getAllMessages(e.match.params.id),function(){Ie.current.getTracks().map((function(e){e.stop()})),Ie.current.getTracks()[1].stop(),B.a.close()}}),[]),Object(i.useEffect)((function(){Se.current&&(Se.current.scrollTop=Se.current.scrollHeight)}),[Se.current,e.messages.length]),Object(i.useEffect)((function(){if(Ne.current){var e=0;Ze&&e++,e+=xt.current.filter((function(e){return!0===e.show})).length,rt(0==e);var t=Math.sqrt(e);t=Ne.current.offsetHeight<Ne.current.offsetWidth?Math.ceil(t):Math.floor(t),Je(t);var n=Math.ceil(e/t);he(Ne.current.offsetHeight/(1.2*n)),Ce(Ne.current.offsetWidth/(1.2*t))}}),[Ne.current,z,Ze,at,ut,xt.current.length]),Object(i.useEffect)((function(){e.getRoomDetails(e.match.params.id,(function(){n&&n.created_by.pk==e.myuser.pk&&(navigator.mediaDevices.getUserMedia({video:{videoConstraints:we},audio:!0}).then((function(e){Re.current.srcObject=e,Ie.current=e,He(e.getVideoTracks()[0]),Me(e)})).catch((function(e){M.b.error("Cannot get access to your camera and video !")})),a(!0)),pt(!0)}))}),[n.id]),Object(i.useEffect)((function(){gt&&(c?navigator.mediaDevices.getUserMedia({video:{videoConstraints:we},audio:!0}).then((function(e){Re.current.srcObject=e,Ie.current=e,He(e.getVideoTracks()[0]),Me(e)})).catch((function(e){M.b.error("Cannot get access to your camera and video !")})):(Boolean(B.a)&&B.a.socketRef&&B.a.close(),B.a.connect("".concat("http:"==window.location.protocol?"ws":"wss","://").concat(window.location.host.includes("localhost:")?"localhost:8000":window.location.hostname,"/ws/chat/").concat(e.currentRoom.sharing_id)),oe(B.a),B.a.sendSignal("join room",{video:Le,audio:ht,onlyChat:!1}),B.a.on("request invite",(function(t){var r=-1!=e.currentRoom.all_users.indexOf(t.id);t.id==e.currentRoom.created_by.pk||r?B.a.sendSignal("accept invite",t.id):e.currentRoom.created_by.pk==e.myuser.pk&&n.created_by.pk!=t.id&&Object(M.b)((function(e){return Object(ce.jsxs)("div",{children:[t.email," wants to join"," ",Object(ce.jsx)(m.a,{color:"inherit",onClick:function(){return n=e.id,r=t.id,B.a.sendSignal("accept invite",r),void M.b.dismiss(n);var n,r},children:"accept"}),Object(ce.jsx)(m.a,{color:"inherit",onClick:function(){return n=e.id,r=t.id,B.a.sendSignal("reject invite",r),void M.b.dismiss(n);var n,r},children:"Decline"})]})}),{icon:"\ud83d\udc64",duration:1e5})})),B.a.on("invite was rejected",(function(n){e.myuser.pk==n.id&&(Object(M.b)("Admin rejected your request",{icon:"\u2139\ufe0f"}),t.push("/"))})),B.a.on("all users",(function(t){if(1==b&&(h(!1),Re.current.srcObject=Ie.current),t.id==e.myuser.pk){var n=[];t.users.forEach((function(t){if(t[0]!==e.myuser.pk&&!Boolean(xt.current.some((function(e){return e.peerID==t[0]})))){var r=function(e,t,n){var r=new T.a({initiator:!0,trickle:!1,stream:n});return r.on("signal",(function(n){B.a.sendSignal("sending signal",{userToSignal:e,callerID:t,signal:n})})),r}(t[0],e.myuser.pk,Ie.current);xt.current.push({peerID:t[0],peerName:t[1],video:t[2],audio:t[3],show:!0,peer:r}),n.push({peerID:t[0],peerName:t[1],video:t[2],audio:t[3],show:!0,peer:r})}})),Y(n)}})),B.a.on("user joined",(function(t){if(t.userID===e.myuser.pk&&!Boolean(xt.current.some((function(e){return e.peerID==t.caller[0]})))){var n=function(e,t,n){var r=new T.a({initiator:!1,trickle:!1,stream:n}),o=t[0];return r.on("signal",(function(e){B.a.sendSignal("returning signal",{signal:e,callerID:o})})),r.signal(e),r}(t.signal,t.caller,Ie.current);Object(M.b)("".concat(t.caller[1]," joined the room."),{icon:"\ud83d\udc4f"}),xt.current.push({peerID:t.caller[0],peerName:t.caller[1],video:t.caller[2],audio:t.caller[3],show:!0,peer:n});var r={peerID:t.caller[0],peerName:t.caller[1],video:t.caller[2],audio:t.caller[3],show:!0,peer:n};Y([].concat(Object(d.a)(z),[r]))}})),B.a.on("receiving returned signal",(function(t){t.userID===e.myuser.pk&&xt.current.find((function(e){return e.peerID===t.id})).peer.signal(t.signal)})),B.a.on("user left",(function(e){var t=xt.current.find((function(t){return t.peerID===e}));t&&(Object(M.b)("".concat(t.peerName," left."),{icon:"\u2139\ufe0f"}),t.peer.destroy());var n=xt.current.filter((function(t){return t.peerID!==e}));xt.current=n,Y(n)})),B.a.on("message received",(function(t){t.user=JSON.parse(t.user),e.myuser.first_name==t.user.first_name||at||Object(M.b)("".concat(t.user.first_name," : ").concat(t.message),{icon:"\ud83d\udcac"}),e.addMessage(t)})),B.a.on("toggle video",(function(t){if(t.id==e.myuser.pk)We(t.value);else{var n=xt.current;for(var r in n)if(n[r].peerID==t.id){n[r].video=t.value;break}Y(Object(d.a)(n)),xt.current=n}})),B.a.on("toggle audio",(function(t){if(t.id==e.myuser.pk)mt(t.value);else{var n=xt.current;for(var r in n)if(n[r].peerID==t.id){n[r].audio=t.value;break}Y(Object(d.a)(n)),xt.current=n}}))))}),[gt,c]);function Dt(){He(Ie.current.getVideoTracks()[0]),navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:"true"}).then((function(e){for(var t=0;t<xt.current.length;t++)xt.current[t].peer.replaceTrack(Ie.current.getVideoTracks()[0],e.getVideoTracks()[0],Ie.current);Y(Object(d.a)(xt.current)),Ie.current.removeTrack(Ie.current.getVideoTracks()[0]),Ie.current.addTrack(e.getVideoTracks()[0]),e.getVideoTracks()[0].onended=function(){for(var e=0;e<xt.current.length;e++)xt.current[e].peer.replaceTrack(Ie.current.getVideoTracks()[0],Ee,Ie.current);Y(Object(d.a)(xt.current)),Ie.current.removeTrack(Ie.current.getVideoTracks()[0]),Ie.current.addTrack(Ee)}}))}function Tt(){""!=E&&B.a.sendSignal("send_message",E),F("")}function At(){dt(!1),it(!at)}function Mt(){it(!1),dt(!ut)}function Bt(){Ie.current.getVideoTracks()[0].enabled=!Ie.current.getVideoTracks()[0].enabled,c?We(!Le):B.a.sendSignal("toggle video")}function _t(){Ie.current.getAudioTracks()[0].enabled=!Ie.current.getAudioTracks()[0].enabled,c?mt(!ht):B.a.sendSignal("toggle audio")}return gt?c||b?Object(ce.jsxs)("div",{children:[Object(ce.jsxs)("div",{className:vt.introLobby,children:[Object(ce.jsx)(je,{video:Le,audio:ht,dimensions:se/Math.sqrt(1+xt.current.length),width:ve,show:Ze,height:de,refer:Re,name:e.myuser.first_name,numpeers:xt.current.length},e.myuser.pk),Object(ce.jsxs)("div",{children:[Object(ce.jsx)(m.a,{disabled:b,onClick:Bt,children:Le?Object(ce.jsx)(H.a,{}):Object(ce.jsx)(V.a,{})}),Object(ce.jsx)(m.a,{disabled:b,onClick:_t,children:ht?Object(ce.jsx)(W.a,{}):Object(ce.jsx)(U.a,{})}),Object(ce.jsx)(m.a,{onClick:function(){e.myuser.pk!=n.created_by.pk&&M.b.success("Notified Admin, waiting for approval..."),h(!0),a(!1)},disabled:b,children:"Join room"})]})]}),Object(ce.jsx)(xe.a,{meeting:!1})]}):Object(ce.jsxs)("div",{className:vt.chatRoom,children:[Object(ce.jsx)(M.a,{}),Object(ce.jsxs)("div",{className:vt.chatRoomMainDiv,children:[Object(ce.jsxs)(O.a,{container:!0,spacing:2,className:vt.paper,ref:Ne,style:{gridTemplateColumns:"repeat(".concat(ze,",1fr)"),position:nt?"relative":""},children:[Object(ce.jsxs)(O.a,{className:vt.actionButtons,children:[Object(ce.jsx)(m.a,{onClick:Bt,children:Le?Object(ce.jsx)(H.a,{}):Object(ce.jsx)(V.a,{})}),Object(ce.jsx)(m.a,{onClick:_t,children:ht?Object(ce.jsx)(W.a,{}):Object(ce.jsx)(U.a,{})}),Object(ce.jsx)(m.a,{onClick:At,children:Object(ce.jsx)(q.a,{})}),Object(ce.jsx)(m.a,{className:vt.desktopButton,onClick:Mt,children:Object(ce.jsx)(ke.a,{})}),Object(ce.jsx)(m.a,{style:{backgroundColor:"red"},onClick:function(){(Ae&&Ae.getTracks()).map((function(e){e.stop()})),t.push("/room/".concat(n.id))},children:Object(ce.jsx)(J.a,{})}),Object(ce.jsx)(m.a,{className:vt.desktopButton,onClick:Dt,children:Object(ce.jsx)(te.a,{})}),Object(ce.jsx)(m.a,{className:vt.desktopButton,onClick:function(){return Ge(!0)},children:Object(ce.jsx)($.a,{})}),Object(ce.jsx)(m.a,{"aria-controls":"avatar-dropdown",content:"avatar",className:vt.mobileButton,onClick:function(e){Ct(e.currentTarget)},startIcon:Object(ce.jsx)(pe.a,{})}),Object(ce.jsxs)(f.a,{id:"avatar-dropdown",anchorEl:wt,open:Boolean(wt),onClose:function(){Ct(null)},style:{marginBottom:"30px"},children:[Object(ce.jsx)(g.a,{onClick:Mt,children:"Manage Users"}),Object(ce.jsx)(g.a,{onClick:Dt,children:"Share Screen"}),Object(ce.jsx)(g.a,{onClick:function(){return Ge(!0)},children:"View Details"})]})]}),Ke&&Object(ce.jsx)(_.a,{show:Ke,meeting:!1,onClose:function(){return Ge(!1)}}),nt&&Object(ce.jsx)(xe.a,{meeting:!1}),Object(ce.jsx)(je,{video:Le,audio:ht,dimensions:se/Math.sqrt(2+xt.current.length),width:ve,height:de,show:Ze,refer:Re,name:e.myuser.first_name,numpeers:xt.current.length},e.myuser.pk-100),xt.current.map((function(e){return Object(ce.jsx)(je,{video:e.video,audio:e.audio,dimensions:se/Math.sqrt(2+xt.current.length),width:ve,height:de,refer:null,show:e.show,peer:e,name:e.peerName,numpeers:xt.current.length},e.peerID)}))]}),at?Object(ce.jsxs)(O.a,{className:vt.chatBox,children:[Object(ce.jsx)(O.a,{className:vt.chatBoxIntro,children:Object(ce.jsx)(p.a,{children:Object(ce.jsx)(X.a,{onClick:At})})}),Object(ce.jsx)(be.a,{}),Object(ce.jsx)(O.a,{className:vt.chatBoxInput,children:Object(ce.jsx)(x.a,{color:"secondary",className:vt.textfield,onChange:function(e){F(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&Tt()},value:E,name:"message",variant:"outlined",autoComplete:!1,label:"",placeholder:"Enter your msg",InputProps:{endAdornment:Object(ce.jsx)(v.a,{position:"end",children:Object(ce.jsx)(p.a,{onClick:Tt,children:Object(ce.jsx)(k.a,{children:Object(ce.jsx)(G.a,{})})})})}})})]}):"",ut?Object(ce.jsxs)(O.a,{className:vt.chatBox,children:[Object(ce.jsx)(O.a,{className:vt.chatBoxIntro,children:Object(ce.jsx)(p.a,{children:Object(ce.jsx)(X.a,{onClick:Mt})})}),Object(ce.jsxs)(O.a,{children:[Object(ce.jsx)(y.a,{children:Object(ce.jsxs)(w.a,{children:[Object(ce.jsx)(C.a,{children:Object(ce.jsx)(R.a,{color:"inherit",children:e.myuser.first_name[0]})}),Object(ce.jsx)(S.a,{primary:e.myuser.first_name}),Object(ce.jsx)(p.a,{onClick:Bt,children:Le?Object(ce.jsx)(H.a,{}):Object(ce.jsx)(V.a,{})}),Object(ce.jsx)(p.a,{onClick:_t,children:ht?Object(ce.jsx)(W.a,{}):Object(ce.jsx)(U.a,{})}),Object(ce.jsx)(p.a,{onClick:function(){Ze?$e(!1):($e(!0),Re.current&&(Re.current.srcObject=Ie.current))},children:Ze?Object(ce.jsx)(me.a,{}):Object(ce.jsx)(fe.a,{})})]},"RemySharp")}),Object(ce.jsx)(N.a,{}),Object(ce.jsx)(O.a,{item:!0,xs:12,style:{padding:"10px"},children:Object(ce.jsx)(x.a,{id:"outlined-basic-email",label:"Search",name:Nt,value:Nt,onChange:function(e){It(e.target.value)},variant:"outlined",fullWidth:!0})}),Object(ce.jsx)(N.a,{}),Object(ce.jsx)(y.a,{children:xt.current.map((function(e){return Object(ce.jsxs)(w.a,{style:{display:e.peerName.includes(Nt)?"":"none"},children:[Object(ce.jsx)(C.a,{children:Object(ce.jsx)(R.a,{color:"inherit",children:e.peerName[0]})}),Object(ce.jsx)(S.a,{primary:e.peerName,children:"Remy Sharp"}),Object(ce.jsx)(p.a,{disabled:!0,children:e.video?Object(ce.jsx)(H.a,{disabled:!0}):Object(ce.jsx)(V.a,{disabled:!0})}),Object(ce.jsx)(p.a,{disabled:!0,children:e.audio?Object(ce.jsx)(W.a,{disabled:!0}):Object(ce.jsx)(U.a,{disabled:!0})}),Object(ce.jsx)(p.a,{onClick:function(){return function(e){var t=xt.current;for(var n in t)if(t[n].peerID==e.peerID){t[n].show=!t[n].show;break}Y(Object(d.a)(t)),xt.current=t}(e)},children:e.show?Object(ce.jsx)(me.a,{}):Object(ce.jsx)(fe.a,{})})]},"RemySharp")}))})]})]}):""]})]}):Object(ce.jsx)("div",{children:"Room doesnt exist"})})),Re=Object(I.i)(Object(l.b)((function(e){return{myuser:e.auth.user,currentRoom:e.room.currentRoom,token:e.auth.token,messages:e.room.messages,userDimension:e.room.userDimension}}),(function(e){return{getRoomDetails:function(t,n){return e(Object(A.e)(t,n))},getAllMessages:function(t,n){return e(Object(A.c)(t,n))},addMessage:function(t){return e(Object(A.a)(t))},setUserDimension:function(t){return e(Object(A.f)(t))}}}))(Ce)),Se=function(e){Object(c.a)(n,e);var t=Object(a.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(ce.jsx)("div",{style:{height:"90vh"},className:"VideoView",children:Object(ce.jsx)(Re,{})})}}]),n}(i.Component);t.default=Object(l.b)((function(e){return{user:e.auth.user}}),(function(e){return{logoutUser:function(){return e(Object(u.d)())}}}))(Se)}}]);
//# sourceMappingURL=6.9797decc.chunk.js.map